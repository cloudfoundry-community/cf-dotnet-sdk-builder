using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using cf_net_sdk.Client.Data;
using cf_net_sdk;
using Newtonsoft.Json;

namespace cf_net_sdk_test.Serialization
{
    [TestClass]
    public class <%= endpoint.name.pretty_name %>Test
    {
<% data_classes["requests"].each do |data_class, body| %>
    <% json_body = JSON.parse(body) %>
        [TestMethod]
        public void Test<%= data_class.name %>()
        {
            string json = @"<%= body.gsub "\"", "\"\"" %>";
            <%= data_class.name %> request = new <%= data_class.name %>();
       <% json_body.each do |key, value|
        next if (value.is_a? Hash) || (value.is_a? Array)
        if (value.is_a? Fixnum) || (value.is_a? Integer) || (value.is_a? Float) || (!!value == value) then val = value
        elsif (value.is_guid?) then val = "new Guid(\"#{value}\")"
        else val = "\"#{value}\"" end %>
            request.<%= key.pretty_name %> = <%= val %>;<% end %>
            string result = JsonConvert.SerializeObject(request);
            Assert.AreEqual(result, json);
        }
<% end %>
    }
}
